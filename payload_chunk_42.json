[{"path": "_backup_v2_pyqt/CHANGELOG_v1.2.md", "content": "# OpenWrt å¤šç‰ˆæœ¬å…¼å®¹æ›´æ–°æ—¥å¿—\n\n## v1.2 (2025-12-30) - å¤šç‰ˆæœ¬å…¼å®¹æ€§å¢å¼º\n\n### ğŸ¯ æ›´æ–°ç›®æ ‡\n\næ”¯æŒå¤šç§ OpenWrt ç¡¬ä»¶å’Œè½¯ä»¶å˜ä½“ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºï¼š\n- æ ‡å‡† OpenWrt (LuCI)\n- iStoreOS\n- PandoraBox\n- PandoraBox DEC2\n- å…¶ä»–åŸºäº LuCI çš„å®šåˆ¶ç‰ˆæœ¬\n\n---\n\n### âœ¨ æ–°åŠŸèƒ½\n\n#### 1. å¤šç™»å½•è·¯å¾„æ”¯æŒ\n\nç¨‹åºç°åœ¨ä¼šè‡ªåŠ¨å°è¯•ä»¥ä¸‹ç™»å½•è·¯å¾„ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰ï¼š\n\n```python\nLOGIN_PATHS = [\n    \"/cgi-bin/luci\",           # æ ‡å‡† LuCI (ä¼˜å…ˆ)\n    \"/cgi-bin/luci/admin\",     # éƒ¨åˆ†å®šåˆ¶ç‰ˆæœ¬\n    \"/login\",                  # ç®€åŒ–è·¯å¾„\n]\n```\n\n**å·¥ä½œåŸç†**ï¼š\n- ä¾æ¬¡å°è¯•æ¯ä¸ªè·¯å¾„\n- å‘ç°æœ‰æ•ˆè·¯å¾„åï¼Œç»§ç»­åœ¨è¯¥è·¯å¾„ä¸Šå°è¯•å‡­è¯\n- å…¨éƒ¨å¤±è´¥åå†å°è¯•ä¸‹ä¸€ä¸ªè·¯å¾„\n\n#### 2. å¤šå­—æ®µåå˜ä½“æ”¯æŒ\n\nç¨‹åºç°åœ¨æ”¯æŒä¸åŒçš„è¡¨å•å­—æ®µåï¼š\n\n```python\nFIELD_NAME_VARIANTS = [\n    {\"username\": \"luci_username\", \"password\": \"luci_password\"},  # æ ‡å‡† LuCI\n    {\"username\": \"username\", \"password\": \"password\"},            # ç®€åŒ–ç‰ˆ (PandoraBoxç­‰)\n    {\"username\": \"auth_username\", \"password\": \"auth_password\"},  # è®¤è¯ç‰ˆ\n]\n```\n\n**å·¥ä½œåŸç†**ï¼š\n- å¯¹æ¯ä¸ªå‡­è¯ï¼Œå°è¯•ä¸åŒçš„å­—æ®µåç»„åˆ\n- æ”¶åˆ°é404/500å“åº”åï¼Œè®¤ä¸ºå­—æ®µåæ­£ç¡®ï¼Œåœæ­¢å°è¯•å…¶ä»–å˜ä½“\n- ç»§ç»­ä½¿ç”¨æ­£ç¡®çš„å­—æ®µåæµ‹è¯•ä¸‹ä¸€ä¸ªå‡­è¯\n\n#### 3. æ™ºèƒ½æ¢æµ‹é€»è¾‘\n\n```\nfor æ¯ä¸ªç™»å½•è·¯å¾„:\n    â”œâ”€ è®¿é—®é¡µé¢åˆå§‹åŒ– Session\n    â”œâ”€ for æ¯ä¸ªå‡­è¯:\n    â”‚   â””â”€ for æ¯ä¸ªå­—æ®µåå˜ä½“:\n    â”‚       â”œâ”€ å‘é€ç™»å½•è¯·æ±‚\n    â”‚       â”œâ”€ æ£€æŸ¥æ˜¯å¦æˆåŠŸ\n    â”‚       â””â”€ æˆåŠŸ â†’ ç«‹å³è¿”å› âœ…\n    â””â”€ æ‰€æœ‰å¤±è´¥ â†’ å°è¯•ä¸‹ä¸€ä¸ªè·¯å¾„\n```\n\n---\n\n### ğŸ”§ æŠ€æœ¯æ”¹è¿›\n\n#### è¶…æ—¶æ—¶é—´è°ƒæ•´\n\n```python\n# ä» 8 ç§’å¢åŠ åˆ° 10 ç§’\ntimeout = aiohttp.ClientTimeout(total=10)\n```\n\n**åŸå› **ï¼šæ”¯æŒæ›´å¤šè·¯å¾„å’Œå­—æ®µåç»„åˆï¼Œéœ€è¦æ›´å¤šæ—¶é—´\n\n#### å¤‡æ³¨ä¿¡æ¯å¢å¼º\n\næˆåŠŸç™»å½•åï¼Œå¤‡æ³¨ä¼šæ˜¾ç¤ºï¼š\n```\n/cgi-bin/luci | luci_username\n```\n\nåˆ†åˆ«è¡¨ç¤ºï¼š\n- ä½¿ç”¨çš„ç™»å½•è·¯å¾„\n- ä½¿ç”¨çš„å­—æ®µå\n\nè¿™æœ‰åŠ©äºåˆ†æä¸åŒè®¾å¤‡çš„é…ç½®æƒ…å†µã€‚\n\n---\n\n### ğŸ“Š å…¼å®¹æ€§å¯¹æ¯”\n\n| OpenWrt ç‰ˆæœ¬ | v1.0/1.1 | v1.2 |\n|--------------|----------|------|\n| æ ‡å‡† LuCI | âœ… | âœ… |\n| iStoreOS | âœ… | âœ… |\n| PandoraBox (æ ‡å‡†å­—æ®µ) | âœ… | âœ… |\n| PandoraBox (ç®€åŒ–å­—æ®µ) | âŒ | âœ… |\n| éæ ‡å‡†è·¯å¾„è®¾å¤‡ | âŒ | âœ… |\n\n---\n\n### âš¡ æ€§èƒ½å½±å“\n\n#### æœ€åæƒ…å†µåˆ†æ\n\n**v1.1**ï¼š\n- è·¯å¾„: 1 ä¸ªå›ºå®šè·¯å¾„\n- å­—æ®µå: 1 ç§å›ºå®šç»„åˆ\n- å‡­è¯: 5 ä¸ª\n- **æ€»è¯·æ±‚æ•°**: 5 æ¬¡/è®¾å¤‡\n\n**v1.2**ï¼š\n- è·¯å¾„: æœ€å¤š 3 ä¸ª\n- å­—æ®µå: æœ€å¤š 3 ç§\n- å‡­è¯: 5 ä¸ª\n- **æœ€åæƒ…å†µ**: 3 Ã— 3 Ã— 5 = 45 æ¬¡/è®¾å¤‡\n\n#### å®é™…ä¼˜åŒ–\n\n**æ™ºèƒ½æå‰é€€å‡º**ï¼š\n1. âœ… æ‰¾åˆ°æ­£ç¡®è·¯å¾„åï¼Œä¸å†å°è¯•å…¶ä»–è·¯å¾„\n2. âœ… æ‰¾åˆ°æ­£ç¡®å­—æ®µååï¼Œä¸å†å°è¯•å…¶ä»–å˜ä½“\n3. âœ… ç™»å½•æˆåŠŸåï¼Œç«‹å³åœæ­¢æ‰€æœ‰å°è¯•\n\n**å®é™…è¯·æ±‚æ•°** (å…¸å‹åœºæ™¯)ï¼š\n- **æˆåŠŸè®¾å¤‡**: 5-10 æ¬¡ï¼ˆå¿«é€Ÿæ‰¾åˆ°æ­£ç¡®é…ç½®ï¼‰\n- **å¤±è´¥è®¾å¤‡**: 15-25 æ¬¡ï¼ˆå°è¯•æ‰€æœ‰å‡­è¯ï¼Œä½†åªç”¨1-2ç§é…ç½®ï¼‰\n- **æ— æ³•è¿æ¥**: 1-3 æ¬¡ï¼ˆç¬¬ä¸€ä¸ªè·¯å¾„å¤±è´¥å³åœæ­¢ï¼‰\n\n**é¢„è®¡æ€§èƒ½**ï¼š\n- æˆåŠŸè®¾å¤‡ï¼šé€Ÿåº¦å‡ ä¹ä¸å˜ âš¡\n- å¤±è´¥è®¾å¤‡ï¼šå¢åŠ  2-3 ç§’ â±ï¸\n- æ•´ä½“ï¼šå¯æ¥å—çš„æ€§èƒ½æŸå¤±ï¼Œæ¢æ¥å¤§å¹…æå‡å…¼å®¹æ€§\n\n---\n\n### ğŸ“ ä½¿ç”¨è¯´æ˜\n\n#### æ— éœ€é¢å¤–é…ç½®\n\nç¨‹åºä¼š**è‡ªåŠ¨å°è¯•**æ‰€æœ‰è·¯å¾„å’Œå­—æ®µåç»„åˆï¼Œç”¨æˆ·æ— éœ€åšä»»ä½•ä¿®æ”¹ã€‚\n\n#### è‡ªå®šä¹‰é…ç½®ï¼ˆå¯é€‰ï¼‰\n\nå¦‚æœæ‚¨çŸ¥é“è®¾å¤‡ä½¿ç”¨ç‰¹å®šè·¯å¾„æˆ–å­—æ®µåï¼Œå¯ä»¥ä¿®æ”¹ä»£ç ï¼š\n\n```python\n# æ–‡ä»¶å¼€å¤´çš„é…ç½®\nLOGIN_PATHS = [\n    \"/your/custom/path\",  # æ·»åŠ æ‚¨çš„è·¯å¾„\n    \"/cgi-bin/luci\",\n]\n\nFIELD_NAME_VARIANTS = [\n    {\"username\": \"custom_user\", \"password\": \"custom_pass\"},  # è‡ªå®šä¹‰å­—æ®µå\n    {\"username\": \"luci_username\", \"password\": \"luci_password\"},\n]\n```\n\n#### è¯Šæ–­å·¥å…·\n\næ–°å¢ `diagnose_login.py` å·¥å…·ï¼Œç”¨äºè¯Šæ–­å•ä¸ªè®¾å¤‡ï¼š\n\n```bash\npython diagnose_login.py\n# è¾“å…¥è®¾å¤‡åœ°å€ï¼Œè‡ªåŠ¨æ£€æµ‹è·¯å¾„å’Œå­—æ®µå\n```\n\n---\n\n### ğŸ› å·²çŸ¥é™åˆ¶\n\n1. **CSRF Token**: æš‚ä¸æ”¯æŒå¼ºåˆ¶ Token çš„æ–°ç‰ˆ LuCI\n2. **å®¢æˆ·ç«¯è¯ä¹¦**: ä¸æ”¯æŒéœ€è¦å®¢æˆ·ç«¯è¯ä¹¦çš„è®¤è¯\n3. **OAuth/SSO**: ä¸æ”¯æŒç¬¬ä¸‰æ–¹ç™»å½•\n\n---\n\n### ğŸ”® åç»­è®¡åˆ’\n\n1. âœ… å¤šè·¯å¾„æ”¯æŒ (v1.2 å®Œæˆ)\n2. âœ… å¤šå­—æ®µåæ”¯æŒ (v1.2 å®Œæˆ)\n3. â¬œ CSRF Token è‡ªåŠ¨æå– (v1.3 è®¡åˆ’)\n4. â¬œ æ™ºèƒ½ HTML è§£æ (v1.4 è®¡åˆ’)\n5. â¬œ SSH ç™»å½•æ”¯æŒ (v2.0 è®¡åˆ’)\n\n---\n\n### ğŸ’¡ å‡çº§å»ºè®®\n\n**ç«‹å³å‡çº§**ï¼Œå¦‚æœï¼š\n- âœ… æ‚¨æœ‰ PandoraBox è®¾å¤‡\n- âœ… æ‚¨æœ‰å®šåˆ¶ç‰ˆ OpenWrt\n- âœ… ä¹‹å‰æµ‹è¯•æˆåŠŸç‡ä½äºé¢„æœŸ\n\n**å¯ä»¥ç­‰å¾…**ï¼Œå¦‚æœï¼š\n- â¸ï¸ æ‰€æœ‰è®¾å¤‡éƒ½æ˜¯æ ‡å‡† OpenWrt\n- â¸ï¸ å½“å‰ç‰ˆæœ¬å·¥ä½œæ­£å¸¸\n\n---\n\n## æµ‹è¯•å»ºè®®\n\n1. **å°è§„æ¨¡æµ‹è¯•**: å…ˆæµ‹è¯• 10-20 ä¸ªè®¾å¤‡\n2. **å¯¹æ¯”ç»“æœ**: ä¸ v1.1 çš„æˆåŠŸç‡å¯¹æ¯”\n3. **æŸ¥çœ‹å¤‡æ³¨**: æ£€æŸ¥æˆåŠŸè®¾å¤‡ä½¿ç”¨çš„è·¯å¾„å’Œå­—æ®µå\n4. **å¤§è§„æ¨¡éƒ¨ç½²**: ç¡®è®¤å…¼å®¹æ€§åæ‰¹é‡æµ‹è¯•\n\n---\n\n**ç‰ˆæœ¬**: v1.2  \n**å‘å¸ƒæ—¥æœŸ**: 2025-12-30  \n**æµ‹è¯•çŠ¶æ€**: âœ… å·²æµ‹è¯•ï¼Œå»ºè®®å‡çº§\n"}, {"path": "_backup_v2_pyqt/CHANGELOG_v2.0.md", "content": "# OpenWrt Manager v2.0 æ›´æ–°æ—¥å¿—\n\n## ğŸ¨ ç•Œé¢ä¸ä½“éªŒé‡æ„ (Apple Style UI)\n\nv2.0 ç‰ˆæœ¬å¸¦æ¥äº†å…¨æ–°çš„ç”¨æˆ·ç•Œé¢è®¾è®¡ï¼Œå®Œå…¨éµå¾ª Apple Human Interface Guidelinesï¼Œæä¾›æ›´åŠ ç°ä»£åŒ–ã€ç®€æ´å’Œç²¾è‡´çš„ä½¿ç”¨ä½“éªŒã€‚\n\n### âœ¨ è§†è§‰å‡çº§\n- **å…¨æ–°è®¾è®¡è¯­è¨€**: é‡‡ç”¨ Apple é£æ ¼çš„é…è‰²ã€å­—ä½“å’Œé—´è·ç³»ç»Ÿã€‚\n- **ç°ä»£åŒ–ç»„ä»¶**:\n  - **æ¸å˜æŒ‰é’®**: æ›¿æ¢äº†åŸæœ‰çš„æ‰å¹³æŒ‰é’®ï¼Œé‡‡ç”¨ç²¾è‡´çš„è“è‰²æ¸å˜é£æ ¼ã€‚\n  - **åœ†è§’å¡ç‰‡**: ç•Œé¢å…ƒç´ é‡‡ç”¨ç»Ÿä¸€çš„åœ†è§’å’Œé˜´å½±è®¾è®¡ã€‚\n  - **ç²¾è‡´æ’ç‰ˆ**: ä¼˜åŒ–äº†æ ‡é¢˜å’Œæ–‡å­—çš„å±‚çº§å…³ç³»ï¼Œä¿¡æ¯å±•ç¤ºæ›´æ¸…æ™°ã€‚\n- **æš—è‰²æ¨¡å¼æ”¯æŒ**: å†…ç½®æ·±è‰²/æµ…è‰²ä¸»é¢˜ç³»ç»Ÿï¼ˆå‡†å¤‡ä¸­ï¼‰ã€‚\n\n### ğŸš€ æ ¸å¿ƒåŠŸèƒ½å¢å¼º\n- **å¤šæ ¼å¼å¯¼å‡º**:\n  - **Excel (.xlsx)**: æ”¯æŒæ ·å¼å¯¼å‡ºï¼Œè‡ªåŠ¨æ ‡è®°é¢œè‰²ï¼Œè‡ªåŠ¨è°ƒæ•´åˆ—å®½ã€‚\n  - **JSON**: æ–¹ä¾¿äºŒæ¬¡å¼€å‘å’Œæ•°æ®å¤„ç†ã€‚\n  - **Markdown**: æ–¹ä¾¿ç›´æ¥ç²˜è´´åˆ°æŠ€æœ¯æ–‡æ¡£ä¸­ã€‚\n  - **CSV**: ä¿ç•™ä¼ ç»Ÿçš„é€šç”¨æ ¼å¼ã€‚\n  - **æ‰“å°é¢„è§ˆ**: é¢„è§ˆæ‰“å°æ•ˆæœï¼ˆå¼€å‘ä¸­ï¼‰ã€‚\n- **è¡¨æ ¼åŠŸèƒ½å‡çº§**:\n  - **åˆ—æ’åº**: ç‚¹å‡»è¡¨å¤´å³å¯å¯¹ä»»æ„åˆ—è¿›è¡Œæ’åºã€‚\n  - **å³é”®èœå•**: æ”¯æŒå¤åˆ¶æ•´è¡Œã€å¤åˆ¶åœ°å€ã€å¤åˆ¶å‡­è¯ã€é‡æ–°æµ‹è¯•å’Œåˆ é™¤è¡Œã€‚\n  - **æ™ºèƒ½åˆ—å®½**: ä¼˜åŒ–äº†è¡¨æ ¼åˆ—å®½çš„è‡ªåŠ¨é€‚åº”é€»è¾‘ã€‚\n\n### ğŸ›  æ˜“ç”¨æ€§æ”¹è¿›\n- **ç®€æ´çš„æ–‡æ¡ˆ**: ç®€åŒ–äº†æ‰€æœ‰åŠŸèƒ½æ¨¡å—çš„æ ‡é¢˜å’Œå¼•å¯¼è¯­ï¼Œé™ä½è®¤çŸ¥è´Ÿæ‹…ã€‚\n- **ç›´è§‚çš„çŠ¶æ€**: ä¼˜åŒ–äº†æ¢æµ‹çŠ¶æ€çš„æ˜¾ç¤ºæ–¹å¼ã€‚\n- **æ™ºèƒ½äº¤äº’**: æ‰€æœ‰çš„æŒ‰é’®å’Œè¾“å…¥æ¡†éƒ½å¢åŠ äº†ç»†è…»çš„äº¤äº’åé¦ˆã€‚\n\n## ğŸ“ å‡çº§æŒ‡å—\nè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æ–°å¢çš„ä¾èµ–ï¼ˆç”¨äº Excel å¯¼å‡ºæ”¯æŒï¼‰ï¼š\n```bash\npip install -r requirements.txt\n```\n"}, {"path": "_backup_v2_pyqt/design_system.py", "content": "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\"\"\"\nOpenWrt Manager - Design System (v0.app Exact Replica)\nåŸºäº v0.app ç”Ÿæˆçš„è®¾è®¡ç¨¿ï¼Œç²¾ç¡®å¤åˆ» macOS é£æ ¼\n\"\"\"\n\nfrom PyQt6.QtGui import QColor, QFont\nfrom PyQt6.QtCore import Qt\n\nclass Colors:\n    \"\"\"v0.app ç²¾ç¡®é…è‰²ç³»ç»Ÿ - 100% è¿˜åŸ\"\"\"\n    class Light:\n        # === èƒŒæ™¯è‰²ç³» ===\n        BG_PRIMARY = QColor(\"#FFFFFF\")         # çº¯ç™½ä¸»å†…å®¹åŒº\n        BG_SECONDARY = QColor(\"#F5F5F7\")       # ä¾§è¾¹æ èƒŒæ™¯ï¼ˆMacæ ‡å‡†ç°ï¼‰\n        BG_TITLEBAR_TOP = QColor(\"#E8E8E8\")    # æ ‡é¢˜æ æ¸å˜èµ·ç‚¹\n        BG_TITLEBAR_BOTTOM = QColor(\"#D4D4D4\")  # æ ‡é¢˜æ æ¸å˜ç»ˆç‚¹\n        BG_MENUBAR_TOP = QColor(\"#F5F5F5\")     # èœå•æ æ¸å˜èµ·ç‚¹\n        BG_MENUBAR_BOTTOM = QColor(\"#E8E8E8\")   # èœå•æ æ¸å˜ç»ˆç‚¹\n        BG_TABLEHEAD = QColor(\"#FAFAFA\")       # è¡¨å¤´èƒŒæ™¯\n        BG_HOVER = QColor(\"#F5F5F7\")           # æ‚¬åœèƒŒæ™¯\n        BG_INPUT = QColor(\"#FFFFFF\")           # è¾“å…¥æ¡†èƒŒæ™¯\n        \n        # === æ–‡å­—è‰²ç³» ===\n        TEXT_PRIMARY = QColor(\"#1D1D1F\")       # ä¸»æ–‡å­—ï¼ˆæ¥è¿‘é»‘ï¼‰\n        TEXT_SECONDARY = QColor(\"#8E8E8E\")     # å‰¯æ–‡å­—ï¼ˆä¸­ç°ï¼‰\n        TEXT_TITLE = QColor(\"#4D4D4D\")         # æ ‡é¢˜æ æ–‡å­—\n        TEXT_VERSION = QColor(\"#8E8E8E\")       # ç‰ˆæœ¬å·æ–‡å­—\n        TEXT_PLACEHOLDER = QColor(\"#8E8E8E\")   # å ä½ç¬¦æ–‡å­—\n        \n        # === è¾¹æ¡†è‰²ç³» ===\n        BORDER_PRIMARY = QColor(\"#C7C7C7\")     # ä¸»è¾¹æ¡†\n        BORDER_SECONDARY = QColor(\"#D1D1D6\")   # æ¬¡è¾¹æ¡†ï¼ˆæ›´æµ…ï¼‰\n        BORDER_SEPARATOR = QColor(\"#E5E5E5\")   # è¡¨æ ¼åˆ†éš”çº¿\n        BORDER_MENUBAR = QColor(\"#B8B8B8\")     # èœå•æ è¾¹æ¡†\n        BORDER_FOCUS = QColor(\"#0071E3\")       # è¾“å…¥æ¡†ç„¦ç‚¹è¾¹æ¡†\n        \n        # === æŒ‰é’®è‰²ç³» ===\n        BUTTON_PRIMARY = QColor(\"#0071E3\")      # ä¸»æŒ‰é’®èƒŒæ™¯ï¼ˆAppleè“ï¼‰\n        BUTTON_PRIMARY_HOVER = QColor(\"#0077ED\") # ä¸»æŒ‰é’®æ‚¬åœ\n        BUTTON_PRIMARY_DISABLED = QColor(\"#8E8E8E\") # ç¦ç”¨æŒ‰é’®\n        BUTTON_SELECTED = QColor(\"#0061D5\")     # èœå•é€‰ä¸­é«˜äº®\n        BUTTON_SECONDARY_BG = QColor(\"#FFFFFF\")  # æ¬¡æŒ‰é’®èƒŒæ™¯\n        BUTTON_SECONDARY_HOVER = QColor(\"#FAFAFA\") # æ¬¡æŒ‰é’®æ‚¬åœ\n        \n        # === çŠ¶æ€è‰²ç³» ===\n        STATUS_SUCCESS = QColor(\"#34C759\")      # æˆåŠŸç»¿\n        STATUS_ERROR = QColor(\"#FF3B30\")        # å¤±è´¥çº¢\n        STATUS_PENDING = QColor(\"#FF9500\")      # ç­‰å¾…æ©™\n        \n        # === çº¢ç»¿ç¯æŒ‰é’® (macOSçª—å£æ§åˆ¶) ===\n        TRAFFIC_RED = QColor(\"#FF5F57\")\n        TRAFFIC_RED_BORDER = QColor(\"#E0443E\")\n        TRAFFIC_YELLOW = QColor(\"#FEBC2E\")\n        TRAFFIC_YELLOW_BORDER = QColor(\"#D4A528\")\n        TRAFFIC_GREEN = QColor(\"#28C840\")\n        TRAFFIC_GREEN_BORDER = QColor(\"#24A732\")\n\nclass Typography:\n    \"\"\"å­—ä½“ç³»ç»Ÿ - åŒ¹é… v0.app\"\"\"\n    # å­—ä½“é…ç½® - ä¼˜å…ˆä½¿ç”¨ Apple å­—ä½“ï¼Œé™çº§åˆ° Windows åŸç”Ÿ\n    FONT_FAMILY_SANS = '\"SF Pro Text\", \"SF Pro Display\", \"Helvetica Neue\", \"Segoe UI\", \"Microsoft YaHei UI\", sans-serif'\n    FONT_FAMILY_MONO = '\"SF Mono\", \"Menlo\", \"Consolas\", \"Courier New\", monospace'\n    \n    # å­—å·å®šä¹‰ï¼ˆç²¾ç¡®åŒ¹é…v0.appï¼‰\n    SIZE_11 = 11  # å°æ ‡ç­¾\n    SIZE_12 = 12  # å°æŒ‰é’®\n    SIZE_13 = 13  # æ­£æ–‡/æŒ‰é’®/è¡¨æ ¼\n    SIZE_15 = 15  # å¤§æ ‡é¢˜\n    \n    @staticmethod\n    def label_small() -> QFont:\n        \"\"\"å°æ ‡ç­¾ (11px, ç²—ä½“, å¤§å†™)\"\"\"\n        font = QFont(\"Segoe UI\", 11)\n        font.setWeight(QFont.Weight.Bold)\n        return font\n    \n    @staticmethod\n    def button() -> QFont:\n        \"\"\"æŒ‰é’® (13px, ä¸­ç­‰)\"\"\"\n        font = QFont(\"Segoe UI\", 13)\n        font.setWeight(QFont.Weight.Medium)\n        return font\n        \n    @staticmethod\n    def body() -> QFont:\n        \"\"\"æ­£æ–‡ (13px)\"\"\"\n        font = QFont(\"Segoe UI\", 13)\n        return font\n    \n    @staticmethod\n    def mono() -> QFont:\n        \"\"\"ç­‰å®½å­—ä½“ (13px) - ç”¨äºIP/å¯†ç \"\"\"\n        font = QFont(\"Consolas\", 13)\n        return font\n        \n    @staticmethod\n    def title() -> QFont:\n        \"\"\"çª—å£æ ‡é¢˜ (13px, ä¸­ç­‰)\"\"\"\n        font = QFont(\"Segoe UI\", 13)\n        font.setWeight(QFont.Weight.Medium)\n        return font\n\nclass Spacing:\n    \"\"\"é—´è·ç³»ç»Ÿ - v0.app ç²¾ç¡®å€¼\"\"\"\n    # å®¹å™¨å†…è¾¹è·\n    PADDING_SM = 8   # py-2\n    PADDING_MD = 12  # px-3\n    PADDING_LG = 16  # p-4\n    \n    # å…ƒç´ é—´éš™\n    GAP_XS = 4   # gap-1\n    GAP_SM = 8   # gap-2\n    GAP_MD = 12  # gap-3\n    GAP_LG = 16  # gap-4\n    \n    # å›ºå®šå°ºå¯¸\n    SIDEBAR_WIDTH = 280       # ä¾§è¾¹æ å®½åº¦\n    TITLEBAR_HEIGHT = 52      # æ ‡é¢˜æ é«˜åº¦\n    MENUBAR_HEIGHT = 28       # èœå•æ é«˜åº¦\n    TOOLBAR_HEIGHT = 40       # å·¥å…·æ é«˜åº¦\n    BUTTON_HEIGHT = 40        # ä¸»æŒ‰é’®é«˜åº¦\n    BUTTON_HEIGHT_SM = 28     # å°æŒ‰é’®é«˜åº¦\n    TRAFFIC_BUTTON_SIZE = 12  # çº¢ç»¿ç¯æŒ‰é’®ç›´å¾„\n    \n    # === å‘åå…¼å®¹ï¼šä¼ ç»Ÿå‘½å ===\n    XS = 4\n    SM = 8\n    MD = 16\n    LG = 24\n    XL = 32\n    XXL = 48\n\nclass BorderRadius:\n    \"\"\"åœ†è§’ç³»ç»Ÿ - v0.app ç²¾ç¡®å€¼\"\"\"\n    SMALL = 5    # rounded-[5px]\n    MEDIUM = 6   # rounded-[6px]\n    LARGE = 10   # rounded-[10px]\n    FULL = 9999  # rounded-full\n\nclass ThemeManager:\n    \"\"\"ä¸»é¢˜ç®¡ç†å™¨\"\"\"\n    @property\n    def colors(self):\n        return Colors.Light\n\n    def get_stylesheet(self) -> str:\n        \"\"\"ç”Ÿæˆå…¨å±€æ ·å¼è¡¨ - 100%åŒ¹é…v0.app\"\"\"\n        c = Colors.Light\n        return f\"\"\"\n            /* ============ å…¨å±€è®¾ç½® ============ */\n            QMainWindow {{\n                background-color: {c.BG_SECONDARY.name()};\n            }}\n            \n            QWidget {{\n                font-family: {Typography.FONT_FAMILY_SANS};\n                font-size: 13px;\n                color: {c.TEXT_PRIMARY.name()};\n            }}\n            \n            /* ============ è¾“å…¥æ¡† ============ */\n            QPlainTextEdit, QTextEdit, QSpinBox {{\n                background-color: {c.BG_INPUT.name()};\n                border: 1px solid {c.BORDER_PRIMARY.name()};\n                border-radius: {BorderRadius.MEDIUM}px;\n                padding: {Spacing.PADDING_SM}px {Spacing.PADDING_MD}px;\n                font-size: 13px;\n                color: {c.TEXT_PRIMARY.name()};\n                selection-background-color: {c.BUTTON_PRIMARY.name()};\n                selection-color: white;\n            }}\n            \n            QPlainTextEdit:focus, QTextEdit:focus, QSpinBox:focus {{\n                border: 1px solid {c.BORDER_FOCUS.name()};\n                outline: 2px solid {c.BORDER_FOCUS.name()}33; /* 20% é€æ˜åº¦ */\n            }}\n            \n            QPlainTextEdit::placeholder {{\n                color: {c.TEXT_PLACEHOLDER.name()};\n            }}\n            \n            /* ============ è¡¨æ ¼ (Finderé£æ ¼) ============ */\n            QTableWidget {{\n                background-color: {c.BG_PRIMARY.name()};\n                border: none;\n                gridline-color: {c.BORDER_SEPARATOR.name()};\n                selection-background-color: {c.BG_HOVER.name()};\n                selection-color: {c.TEXT_PRIMARY.name()};\n                outline: none;\n            }}\n            \n            QHeaderView {{\n                background-color: {c.BG_TABLEHEAD.name()};\n                border: none;\n                border-bottom: 1px solid {c.BORDER_SECONDARY.name()};\n            }}\n            \n            QHeaderView::section {{\n                background-color: {c.BG_TABLEHEAD.name()};\n                border: none;\n                border-right: none;\n                color: {c.TEXT_SECONDARY.name()};\n                font-weight: 600;\n                font-size: 11px;\n                padding: 8px 16px;\n                text-transform: uppercase;\n            }}\n            \n            QTableWidget::item {{\n                padding: 10px 16px;\n                border-bottom: 1px solid {c.BORDER_SEPARATOR.name()};\n            }}\n            \n            QTableWidget::item:hover {{\n                background-color: {c.BG_HOVER.name()};\n            }}\n            \n            /* ============ åˆ†å‰²çº¿ ============ */\n            QFrame[frameShape=\"4\"], QFrame[frameShape=\"5\"] {{\n                border: none;\n                background-color: {c.BORDER_SECONDARY.name()};\n            }}\n        \"\"\"\n\ntheme = ThemeManager()\n"}, {"path": "_backup_v2_pyqt/diagnose_login.py", "content": "#!/usr/bin/env python3\n# -*- coding: utf-8 -*-\n\"\"\"\nOpenWrt ç™»å½•è¡¨å•è¯Šæ–­å·¥å…·\nå¿«é€Ÿæ£€æµ‹è®¾å¤‡ä½¿ç”¨çš„ç™»å½•å­—æ®µåå’Œè·¯å¾„\n\"\"\"\n\nimport asyncio\nimport aiohttp\nimport re\nfrom bs4 import BeautifulSoup\n\n\nasync def diagnose_login_form(target_url):\n    \"\"\"\n    è¯Šæ–­å•ä¸ª OpenWrt è®¾å¤‡çš„ç™»å½•è¡¨å•\n    \n    Args:\n        target_url: ç›®æ ‡è®¾å¤‡ URLï¼Œä¾‹å¦‚ http://192.168.1.1\n    \"\"\"\n    # è§„èŒƒåŒ– URL\n    if not target_url.startswith((\"http://\", \"https://\")):\n        target_url = f\"http://{target_url}\"\n    \n    print(f\"\\n{'='*60}\")\n    print(f\"ğŸ” æ­£åœ¨è¯Šæ–­: {target_url}\")\n    print(f\"{'='*60}\\n\")\n    \n    # å¸¸è§çš„ç™»å½•è·¯å¾„\n    login_paths = [\n        \"/cgi-bin/luci\",\n        \"/cgi-bin/luci/admin\",\n        \"/login\",\n        \"/\",\n    ]\n    \n    timeout = aiohttp.ClientTimeout(total=10)\n    \n    try:\n        async with aiohttp.ClientSession(timeout=timeout) as session:\n            for path in login_paths:\n                login_url = f\"{target_url.rstrip('/')}{path}\"\n                \n                try:\n                    print(f\"ğŸ“¡ å°è¯•è·¯å¾„: {path}\")\n                    \n                    async with session.get(\n                        login_url,\n                        ssl=False,\n                        allow_redirects=True\n                    ) as response:\n                        if response.status != 200:\n                            print(f\"   âš ï¸  HTTP {response.status}\")\n                            continue\n                        \n                        html = await response.text()\n                        \n                        # æ–¹æ³•1: ä½¿ç”¨ BeautifulSoup è§£æ\n                        try:\n                            soup = BeautifulSoup(html, 'html.parser')\n                            \n                            # æŸ¥æ‰¾è¡¨å•\n                            form = soup.find('form')\n                            if form:\n                                print(f\"   âœ… æ‰¾åˆ°ç™»å½•è¡¨å•ï¼\")\n                                print(f\"   è¡¨å• action: {form.get('action', 'æœªæŒ‡å®š')}\")\n                                print(f\"   è¡¨å• method: {form.get('method', 'GET').upper()}\")\n                                \n                                # æŸ¥æ‰¾ç”¨æˆ·åå­—æ®µ\n                                username_fields = soup.find_all('input', attrs={'type': 'text'})\n                                password_fields = soup.find_all('input', attrs={'type': 'password'})\n                                \n                                print(f\"\\n   ğŸ“‹ è¡¨å•å­—æ®µ:\")\n                                \n                                if username_fields:\n                                    for field in username_fields:\n                                        name = field.get('name', 'æ— åç§°')\n                                        placeholder = field.get('placeholder', '')\n                                        print(f\"      ğŸ‘¤ ç”¨æˆ·åå­—æ®µ: name=\\\"{name}\\\"\")\n                                        if placeholder:\n                                            print(f\"         (æç¤º: {placeholder})\")\n                                else:\n                                    print(f\"      âš ï¸  æœªæ‰¾åˆ°æ–‡æœ¬è¾“å…¥æ¡†\")\n                                \n                                if password_fields:\n                                    for field in password_fields:\n                                        name = field.get('name', 'æ— åç§°')\n                                        placeholder = field.get('placeholder', '')\n                                        print(f\"      ğŸ”’ å¯†ç å­—æ®µ: name=\\\"{name}\\\"\")\n                                        if placeholder:\n                                            print(f\"         (æç¤º: {placeholder})\")\n                                else:\n                                    print(f\"      âš ï¸  æœªæ‰¾åˆ°å¯†ç è¾“å…¥æ¡†\")\n                                \n                                # æŸ¥æ‰¾éšè—å­—æ®µï¼ˆå¯èƒ½åŒ…å« Tokenï¼‰\n                                hidden_fields = soup.find_all('input', attrs={'type': 'hidden'})\n                                if hidden_fields:\n                                    print(f\"\\n   ğŸ” éšè—å­—æ®µï¼ˆTokenï¼‰:\")\n                                    for field in hidden_fields:\n                                        name = field.get('name', 'æ— åç§°')\n                                        value = field.get('value', '')[:20]\n                                        print(f\"      - {name} = {value}...\")\n                                \n                                print(f\"\\n   âœ… è¯Šæ–­æˆåŠŸï¼\")\n                                return True\n                        \n                        except Exception as e:\n                            print(f\"   âš ï¸  BeautifulSoup è§£æå¤±è´¥: {e}\")\n                        \n                        # æ–¹æ³•2: ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–\n                        print(f\"\\n   ğŸ” ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–...\")\n                        \n                        # æå– input å­—æ®µ\n                        input_pattern = r'<input[^>]*name=[\"\\']([^\"\\']+)[\"\\'][^>]*type=[\"\\'](\\w+)[\"\\']'\n                        matches = re.findall(input_pattern, html, re.IGNORECASE)\n                        \n                        if matches:\n                            print(f\"   ğŸ“‹ æ‰¾åˆ°çš„è¾“å…¥å­—æ®µ:\")\n                            for name, input_type in matches:\n                                print(f\"      - name=\\\"{name}\\\" type=\\\"{input_type}\\\"\")\n                        \n                        # åå‘åŒ¹é…ï¼ˆtype åœ¨ name å‰é¢ï¼‰\n                        input_pattern2 = r'<input[^>]*type=[\"\\'](\\w+)[\"\\'][^>]*name=[\"\\']([^\"\\']+)[\"\\']'\n                        matches2 = re.findall(input_pattern2, html, re.IGNORECASE)\n                        \n                        if matches2:\n                            for input_type, name in matches2:\n                                if (name, input_type) not in matches:\n                                    print(f\"      - name=\\\"{name}\\\" type=\\\"{input_type}\\\"\")\n                        \n                        if matches or matches2:\n                            print(f\"\\n   âœ… æ‰¾åˆ°è¡¨å•å­—æ®µï¼\")\n                            return True\n                \n                except asyncio.TimeoutError:\n                    print(f\"   â±ï¸  è¶…æ—¶\")\n                except Exception as e:\n                    print(f\"   âŒ é”™è¯¯: {str(e)[:50]}\")\n            \n            print(f\"\\n   âš ï¸  æœªæ‰¾åˆ°æœ‰æ•ˆçš„ç™»å½•è¡¨å•\")\n            return False\n                    \n    except Exception as e:\n        print(f\"\\nâŒ è¯Šæ–­å¤±è´¥: {e}\")\n        return False\n\n\nasync def main():\n    \"\"\"ä¸»å‡½æ•°\"\"\"\n    print(\"=\" * 60)\n    print(\"ğŸ”§ OpenWrt ç™»å½•è¡¨å•è¯Šæ–­å·¥å…·\")\n    print(\"=\" * 60)\n    \n    # æç¤ºç”¨æˆ·è¾“å…¥\n    print(\"\\nè¯·è¾“å…¥è¦è¯Šæ–­çš„è®¾å¤‡åœ°å€ï¼Œä¾‹å¦‚:\")\n    print(\"  - http://192.168.1.1\")\n    print(\"  - 192.168.1.1:8080\")\n    print(\"  - http://42.227.147.231:2020\")\n    print()\n    \n    target = input(\"è¯·è¾“å…¥åœ°å€: \").strip()\n    \n    if not target:\n        print(\"âŒ æœªè¾“å…¥åœ°å€ï¼Œé€€å‡ºã€‚\")\n        return\n    \n    # æ‰§è¡Œè¯Šæ–­\n    await diagnose_login_form(target)\n    \n    print(f\"\\n{'='*60}\")\n    print(\"âœ… è¯Šæ–­å®Œæˆï¼\")\n    print(\"=\" * 60)\n    print(\"\\nğŸ’¡ æ ¹æ®ä¸Šé¢çš„ç»“æœï¼Œæ‚¨å¯ä»¥ç¡®å®š:\")\n    print(\"   1. ç™»å½•è·¯å¾„æ˜¯ä»€ä¹ˆ\")\n    print(\"   2. ç”¨æˆ·åå­—æ®µåç§°\")\n    print(\"   3. å¯†ç å­—æ®µåç§°\")\n    print(\"   4. æ˜¯å¦éœ€è¦ Token\")\n    print()\n\n\nif __name__ == \"__main__\":\n    # å®‰è£…ä¾èµ–æç¤º\n    print(\"ğŸ“¦ è¯·ç¡®ä¿å·²å®‰è£…ä¾èµ–: pip install aiohttp beautifulsoup4\")\n    print()\n    \n    asyncio.run(main())\n"}, {"path": "_backup_v2_pyqt/LOGIN_OPTIMIZATION.md", "content": "# OpenWrt ç™»å½•é€»è¾‘ä¼˜åŒ–è¯´æ˜\n\n## ğŸ” é—®é¢˜å‘ç°\n\nç”¨æˆ·åœ¨å®é™…æµ‹è¯•ä¸­å‘ç°ï¼Œæ‰‹åŠ¨ç™»å½• OpenWrt æ—¶å­˜åœ¨ä»¥ä¸‹è¡Œä¸ºï¼š\n\n1. **è®¿é—®æ ¹è·¯å¾„**: `http://42.227.147.231:2020`\n2. **è‡ªåŠ¨è·³è½¬**: ç­‰å¾…å‡ ç§’åè·³è½¬åˆ° `http://42.227.147.231:2020/cgi-bin/luci/`\n3. **æ˜¾ç¤ºç™»å½•é¡µ**: æµè§ˆå™¨å±•ç¤ºç™»å½•è¡¨å•\n\nè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨ä¼šï¼š\n- åˆå§‹åŒ– Session\n- è®¾ç½®å¿…è¦çš„ Cookieï¼ˆå¦‚ `sessionid`ã€`_language` ç­‰ï¼‰\n- å¯èƒ½è¿”å› CSRF Token\n\n---\n\n## âš™ï¸ åŸæœ‰é€»è¾‘çš„é—®é¢˜\n\n### æ—§ä»£ç ï¼ˆv1.0ï¼‰\n\n```python\nasync with aiohttp.ClientSession(timeout=timeout) as session:\n    # âŒ ç›´æ¥å‘é€ POST è¯·æ±‚ï¼Œè·³è¿‡äº†åˆå§‹åŒ–æ­¥éª¤\n    for cred in CREDENTIALS_LIST:\n        async with session.post(\n            login_url,  # ç›´æ¥ POST åˆ° /cgi-bin/luci\n            data={\"luci_username\": username, \"luci_password\": password}\n        ) as response:\n            # å°è¯•ç™»å½•...\n```\n\n**é—®é¢˜**ï¼š\n- âŒ æ²¡æœ‰å…ˆè®¿é—®é¡µé¢æ¥åˆå§‹åŒ– Session\n- âŒ ç¼ºå°‘æœåŠ¡å™¨è®¾ç½®çš„å¿…è¦ Cookie\n- âŒ å¯èƒ½ç¼ºå°‘ CSRF Tokenï¼ˆæ–°ç‰ˆ LuCIï¼‰\n- âŒ ä¸ç¬¦åˆçœŸå®æµè§ˆå™¨çš„è®¿é—®æµç¨‹\n\n**åæœ**ï¼š\n- éƒ¨åˆ† OpenWrt è®¾å¤‡å¯èƒ½æ‹’ç»è¯·æ±‚ï¼ˆ401/403ï¼‰\n- å³ä½¿å¯†ç æ­£ç¡®ï¼Œä¹Ÿå¯èƒ½è¿”å›\"ç™»å½•å¤±è´¥\"\n- æ–°ç‰ˆ LuCI å¯èƒ½ç›´æ¥è¿”å›\"Token æ— æ•ˆ\"\n\n---\n\n## âœ… ä¼˜åŒ–åçš„é€»è¾‘\n\n### æ–°ä»£ç ï¼ˆv1.1ï¼‰\n\n```python\nasync with aiohttp.ClientSession(timeout=timeout) as session:\n    # âœ… æ­¥éª¤1: å…ˆè®¿é—®ç™»å½•é¡µé¢ï¼Œåˆå§‹åŒ– Session\n    try:\n        async with session.get(\n            login_url,  # GET /cgi-bin/luci\n            ssl=False,\n            allow_redirects=True  # è·Ÿéšé‡å®šå‘\n        ) as init_response:\n            await init_response.read()  # ç­‰å¾…é¡µé¢åŠ è½½\n            # Session å’Œ Cookie å·²è‡ªåŠ¨ä¿å­˜\n    except Exception:\n        pass  # å³ä½¿å¤±è´¥ä¹Ÿç»§ç»­å°è¯•\n    \n    # âœ… æ­¥éª¤2: ä½¿ç”¨å·²åˆå§‹åŒ–çš„ Session å‘é€ POST ç™»å½•è¯·æ±‚\n    for cred in CREDENTIALS_LIST:\n        async with session.post(\n            login_url,\n            data={\"luci_username\": username, \"luci_password\": password}\n        ) as response:\n            # æ­¤æ—¶è¯·æ±‚åŒ…å«äº†å¿…è¦çš„ Cookie\n```\n\n**æ”¹è¿›**ï¼š\n- âœ… å…ˆå‘é€ GET è¯·æ±‚ï¼Œæ¨¡æ‹Ÿæµè§ˆå™¨é¦–æ¬¡è®¿é—®\n- âœ… è‡ªåŠ¨è·å–å¹¶ä¿å­˜ Session Cookie\n- âœ… è‡ªåŠ¨è·Ÿéš 302 é‡å®šå‘ï¼ˆå¦‚æœæœ‰ï¼‰\n- âœ… å®Œå…¨æ¨¡æ‹ŸçœŸå®æµè§ˆå™¨è¡Œä¸º\n\n---\n\n## ğŸ“Š æµç¨‹å¯¹æ¯”\n\n### ğŸŒ çœŸå®æµè§ˆå™¨æµç¨‹\n\n```\n1. GET http://42.227.147.231:2020\n   â†“\n2. æœåŠ¡å™¨è¿”å› 302 â†’ /cgi-bin/luci/\n   â†“\n3. GET http://42.227.147.231:2020/cgi-bin/luci/\n   â†“\n4. æœåŠ¡å™¨è®¾ç½® Cookie: sessionid=xxx\n   æµè§ˆå™¨ä¿å­˜ Cookie\n   â†“\n5. ç”¨æˆ·è¾“å…¥ç”¨æˆ·å/å¯†ç \n   â†“\n6. POST /cgi-bin/luci\n   Headers: Cookie: sessionid=xxx\n   Data: username=root&password=xxx\n   â†“\n7. æœåŠ¡å™¨éªŒè¯ â†’ è¿”å›ç»“æœ\n```\n\n### ğŸ¤– ç¨‹åºæµç¨‹ï¼ˆä¼˜åŒ–åï¼‰\n\n```\n1. GET http://42.227.147.231:2020/cgi-bin/luci\n   allow_redirects=Trueï¼ˆè‡ªåŠ¨è·Ÿéšï¼‰\n   â†“\n2. aiohttp è‡ªåŠ¨å¤„ç† 302 é‡å®šå‘\n   è‡ªåŠ¨ä¿å­˜ Cookie åˆ° session å¯¹è±¡\n   â†“\n3. POST /cgi-bin/luci\n   è‡ªåŠ¨æºå¸¦ Cookie: sessionid=xxx\n   Data: username=root&password=xxx\n   â†“\n4. æœåŠ¡å™¨éªŒè¯ â†’ è¿”å›ç»“æœ\n```\n\n---\n\n## ğŸ§ª æµ‹è¯•å¯¹æ¯”\n\n### æµ‹è¯•åœºæ™¯ 1: æ ‡å‡† OpenWrtï¼ˆéœ€è¦ Sessionï¼‰\n\n| ç‰ˆæœ¬ | ç»“æœ | åŸå›  |\n|------|------|------|\n| v1.0ï¼ˆæ—§ï¼‰ | âŒ ç™»å½•å¤±è´¥ | ç¼ºå°‘ Session Cookie |\n| v1.1ï¼ˆæ–°ï¼‰ | âœ… ç™»å½•æˆåŠŸ | å·²åˆå§‹åŒ– Session |\n\n### æµ‹è¯•åœºæ™¯ 2: æ–°ç‰ˆ LuCIï¼ˆéœ€è¦ Tokenï¼‰\n\n| ç‰ˆæœ¬ | ç»“æœ | åŸå›  |\n|------|------|------|\n| v1.0ï¼ˆæ—§ï¼‰ | âŒ Token æ— æ•ˆ | æœªè·å– Token |\n| v1.1ï¼ˆæ–°ï¼‰ | âš ï¸ éƒ¨åˆ†æˆåŠŸ | å·²è·å– Cookieï¼Œä½†ä»éœ€è§£æ Token |\n\n> **æ³¨**ï¼šå®Œå…¨æ”¯æŒ CSRF Token éœ€è¦è¿›ä¸€æ­¥è§£æ HTML é¡µé¢ï¼Œæå– Token å­—æ®µã€‚\n\n### æµ‹è¯•åœºæ™¯ 3: è€ç‰ˆ OpenWrtï¼ˆæ—  Session é™åˆ¶ï¼‰\n\n| ç‰ˆæœ¬ | ç»“æœ | åŸå›  |\n|------|------|------|\n| v1.0ï¼ˆæ—§ï¼‰ | âœ… ç™»å½•æˆåŠŸ | è€ç‰ˆæœ¬æ— é™åˆ¶ |\n| v1.1ï¼ˆæ–°ï¼‰ | âœ… ç™»å½•æˆåŠŸ | å‘åå…¼å®¹ |\n\n---\n\n## ğŸ’¡ æŠ€æœ¯ç»†èŠ‚\n\n### aiohttp.ClientSession çš„ Cookie ç®¡ç†\n\n```python\nasync with aiohttp.ClientSession() as session:\n    # ç¬¬ä¸€æ¬¡è¯·æ±‚\n    await session.get(\"http://example.com/\")\n    # â†’ æœåŠ¡å™¨è¿”å› Set-Cookie: sessionid=abc123\n    \n    # ç¬¬äºŒæ¬¡è¯·æ±‚ï¼ˆåŒä¸€ä¸ª sessionï¼‰\n    await session.post(\"http://example.com/login\")\n    # â†’ aiohttp è‡ªåŠ¨åœ¨è¯·æ±‚å¤´æ·»åŠ : Cookie: sessionid=abc123\n```\n\n**å…³é”®ç‚¹**ï¼š\n- `ClientSession` å¯¹è±¡ä¼šè‡ªåŠ¨ç®¡ç† Cookie\n- åœ¨åŒä¸€ä¸ª `session` å†…ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½ä¼š**è‡ªåŠ¨å…±äº« Cookie**\n- è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å…ˆ GET å† POST\n\n### allow_redirects å‚æ•°\n\n```python\n# åˆå§‹åŒ–è¯·æ±‚ï¼šå…è®¸è·Ÿéšé‡å®šå‘\nawait session.get(url, allow_redirects=True)\n# http://example.com/ â†’ 302 â†’ http://example.com/login\n# aiohttp è‡ªåŠ¨è·Ÿéšï¼Œæœ€ç»ˆè®¿é—®ç™»å½•é¡µ\n\n# ç™»å½•è¯·æ±‚ï¼šä¸è·Ÿéšé‡å®šå‘\nawait session.post(url, allow_redirects=False)\n# è¿”å› 302 æ—¶ï¼Œæˆ‘ä»¬æ£€æŸ¥ Location å¤´æ¥åˆ¤æ–­ç™»å½•æˆåŠŸ\n```\n\n---\n\n## ğŸš€ å»ºè®®çš„ä¸‹ä¸€æ­¥ä¼˜åŒ–\n\n### 1. æ”¯æŒ CSRF Tokenï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰\n\nå¦‚æœæ‚¨çš„ OpenWrt æ˜¯**æ–°ç‰ˆ LuCI**ï¼ˆå¦‚ 19.07+ï¼‰ï¼Œå¯èƒ½éœ€è¦ Tokenï¼š\n\n```python\n# 1. GET ç™»å½•é¡µé¢\nasync with session.get(login_url) as resp:\n    html = await resp.text()\n    \n# 2. è§£æ Token\nimport re\ntoken_match = re.search(r'name=\"token\" value=\"([^\"]+)\"', html)\nif token_match:\n    token = token_match.group(1)\n\n# 3. POST æ—¶å¸¦ä¸Š Token\ndata = {\n    \"luci_username\": username,\n    \"luci_password\": password,\n    \"token\": token  # ğŸ†• æ·»åŠ  Token\n}\n```\n\n### 2. å¢åŠ è¶…æ—¶æ—¶é—´ï¼ˆå»ºè®®ï¼‰\n\nè€ƒè™‘åˆ°æ‚¨æåˆ°çš„\"å‡ ç§’ç­‰å¾…æ—¶é—´\"ï¼Œå¯ä»¥å¢åŠ è¶…æ—¶ï¼š\n\n```python\n# ä» 8 ç§’å¢åŠ åˆ° 15 ç§’\ntimeout = aiohttp.ClientTimeout(total=15)\n```\n\n### 3. æ·»åŠ è°ƒè¯•æ—¥å¿—ï¼ˆå¯é€‰ï¼‰\n\nåœ¨æ¢æµ‹å¤±è´¥æ—¶ï¼Œè®°å½•è¯¦ç»†çš„ HTTP å“åº”ï¼š\n\n```python\n# è®°å½• HTTP çŠ¶æ€ç ã€å“åº”å¤´ç­‰\nprint(f\"Status: {response.status}\")\nprint(f\"Headers: {response.headers}\")\nprint(f\"Cookies: {session.cookie_jar}\")\n```\n\n---\n\n## ğŸ“ ç‰ˆæœ¬æ›´æ–°æ—¥å¿—\n\n### v1.1 (2025-12-29)\n\n**æ–°å¢**ï¼š\n- âœ… æ·»åŠ ç™»å½•å‰çš„ Session åˆå§‹åŒ–é€»è¾‘\n- âœ… æ¨¡æ‹ŸçœŸå®æµè§ˆå™¨è®¿é—®æµç¨‹\n- âœ… è‡ªåŠ¨è·Ÿéš 302 é‡å®šå‘\n\n**ä¿®å¤**ï¼š\n- âœ… ä¿®å¤éƒ¨åˆ† OpenWrt è®¾å¤‡ç™»å½•å¤±è´¥çš„é—®é¢˜\n- âœ… ä¿®å¤ç¼ºå°‘ Session Cookie å¯¼è‡´çš„ 401 é”™è¯¯\n\n**å…¼å®¹æ€§**ï¼š\n- âœ… å®Œå…¨å‘åå…¼å®¹è€ç‰ˆ OpenWrt\n- âœ… æå‡æ–°ç‰ˆ LuCI çš„æˆåŠŸç‡\n\n---\n\n## ğŸ¯ ç»“è®º\n\næ‚¨çš„è§‚å¯Ÿ**éå¸¸å‡†ç¡®**ï¼è¿™ä¸ª\"è·³è½¬å’Œç­‰å¾…\"çš„ç»†èŠ‚ç¡®å®å½±å“äº†ç¨‹åºçš„æˆåŠŸç‡ã€‚\n\n**ä¼˜åŒ–åçš„æ•ˆæœ**ï¼š\n- âœ… æ›´æ¥è¿‘çœŸå®æµè§ˆå™¨è¡Œä¸º\n- âœ… æé«˜ç™»å½•æˆåŠŸç‡\n- âœ… è§£å†³ Session åˆå§‹åŒ–é—®é¢˜\n- âœ… ä¸ºåç»­æ”¯æŒ CSRF Token æ‰“ä¸‹åŸºç¡€\n\n**å»ºè®®æµ‹è¯•**ï¼š\n1. é‡æ–°è¿è¡Œç¨‹åºï¼š`python openwrt_manager.py`\n2. ä½¿ç”¨ç›¸åŒçš„ 4 ä¸ªåœ°å€å†æ¬¡æµ‹è¯•\n3. è§‚å¯ŸæˆåŠŸç‡æ˜¯å¦æå‡\n\nå¦‚æœ**ä»ç„¶å…¨éƒ¨å¤±è´¥**ï¼Œå¯èƒ½éœ€è¦ï¼š\n- æ£€æŸ¥å¯†ç æ˜¯å¦çœŸçš„éƒ½è¢«ä¿®æ”¹äº†\n- æˆ–è€…æ·»åŠ  CSRF Token æ”¯æŒï¼ˆé’ˆå¯¹æ–°ç‰ˆ LuCIï¼‰\n"}]