# OpenWrt 批量资产管理助手 - 使用指南

## 📝 快速开始

### 步骤 1: 安装依赖

打开命令行，进入项目目录，执行：

```bash
pip install -r requirements.txt
```

### 步骤 2: 运行程序

```bash
python openwrt_manager.py
```

---

## 🎯 使用教程

### 1. 准备目标地址列表

在左侧 "批量输入目标地址" 文本框中，**每行输入一个** OpenWrt 路由器的管理地址：

**支持的格式：**
```
http://192.168.1.1
192.168.1.2
https://192.168.10.1
10.0.0.1:8080
```

**示例：**
```
192.168.1.1
192.168.1.2
192.168.1.3
192.168.2.1
```

### 2. 调整并发数（可选）

- 默认并发数为 **50**（推荐值）
- 如果网络较慢，建议降低到 **20-30**
- 如果网络很快且设备性能好，可提高到 **100-200**

### 3. 开始探测

点击 **"▶ 开始探测"** 按钮：

- 呼吸灯会变为 **绿色** 并开始闪烁
- 右侧表格会实时显示探测进度
- 左下角的统计信息会实时更新

### 4. 查看结果

表格会显示每个目标的探测结果：

| 颜色 | 状态 | 说明 |
|------|------|------|
| 🟢 **浅绿色** | 登录成功 | 找到了有效的账号密码 |
| 🔴 **浅红色** | 登录失败 | 所有凭证都无效 |
| 🔴 **浅红色** | 连接超时 | 设备响应超过 8 秒 |
| 🔴 **浅红色** | 无法连接 | 网络不通或端口未开放 |

### 5. 停止探测（可选）

如果需要中途停止，点击 **"⏸ 停止探测"** 按钮。

### 6. 导出结果

探测完成后，点击 **"💾 导出为 CSV"** 按钮：

- 选择保存位置
- 文件名默认为 `openwrt_results_YYYYMMDD_HHMMSS.csv`
- 可用 Excel 或其他表格软件打开

---

## 🔑 默认探测的凭证

程序会按以下顺序尝试登录：

1. `root` / `password` ⭐ **优先**
2. `root` / `admin`
3. `admin` / `admin`
4. `ubnt` / `ubnt`
5. `root` / `123456`

### 如何修改凭证？

编辑 `openwrt_manager.py` 文件，找到开头的 `CREDENTIALS_LIST` 变量：

```python
CREDENTIALS_LIST = [
    {"username": "root", "password": "password"},  # 默认优先
    {"username": "root", "password": "admin"},
    {"username": "admin", "password": "admin"},
    {"username": "ubnt", "password": "ubnt"},
    {"username": "root", "password": "123456"},
    # 添加你自己的凭证：
    # {"username": "自定义用户名", "password": "自定义密码"},
]
```

---

## ⚙️ 高级设置

### 修改超时时间

默认每个请求的超时时间为 **8 秒**。如果网络环境较差，可以增加超时时间：

在 `openwrt_manager.py` 中找到：

```python
timeout = aiohttp.ClientTimeout(total=8)  # 修改这里的数字
```

### 修改登录 URL

默认登录路径为 `/cgi-bin/luci`（OpenWrt 标准路径）。

如果你的设备使用不同的登录路径，可以修改：

```python
login_url = f"{target_url.rstrip('/')}/cgi-bin/luci"  # 修改这里
```

---

## 🐛 常见问题

### Q1: 提示 "ModuleNotFoundError: No module named 'PyQt6'"

**A:** 需要安装依赖，运行：

```bash
pip install -r requirements.txt
```

### Q2: 所有设备都显示 "无法连接"

**A:** 可能原因：
1. 目标设备不在线
2. 网络不通（检查是否在同一网段）
3. 防火墙阻止了连接
4. 端口不正确（默认是 80/443）

### Q3: 探测速度太慢

**A:** 尝试：
1. 增加并发数（例如 100）
2. 减少超时时间（改为 5 秒）

### Q4: 窗口卡顿或无响应

**A:** 可能原因：
1. 并发数设置过高，降低到 30-50
2. 电脑性能不足

### Q5: CSV 导出后出现乱码

**A:** 使用 Excel 打开时：
1. 数据 → 获取数据 → 从文件 → 从文本/CSV
2. 选择文件编码为 **UTF-8**

---

## 📊 性能参考

| 设备数量 | 推荐并发数 | 预计耗时（每个凭证 8 秒超时） |
|----------|------------|-------------------------------|
| 10       | 10         | ~8-40 秒                      |
| 100      | 50         | ~1-5 分钟                     |
| 500      | 100        | ~3-10 分钟                    |
| 1000     | 150        | ~5-15 分钟                    |

> **注意**：实际耗时取决于网络速度、设备响应速度和有效凭证的位置。

---

## 🛡️ 安全提醒

1. ⚠️ **仅在内网环境使用**：本工具会忽略 SSL 证书验证
2. ⚠️ **保护导出的 CSV 文件**：文件中包含明文密码
3. ⚠️ **遵守法律法规**：仅用于合法的运维管理，禁止未授权访问

---

## 💡 使用技巧

1. **批量粘贴**：可以从 Excel、文本文件直接复制粘贴地址列表
2. **实时监控**：探测过程中可以实时查看成功/失败数量
3. **分批探测**：如果设备太多，可以分批次探测
4. **保存结果**：每次探测完成后建议立即导出 CSV 保存

---

## 🔧 故障排除

### 日志查看

如果遇到问题，可以在命令行中运行程序查看详细日志：

```bash
python openwrt_manager.py
```

错误信息会显示在命令行窗口中。

### 重新安装依赖

如果程序无法运行，尝试重新安装依赖：

```bash
pip uninstall PyQt6 aiohttp qasync -y
pip install -r requirements.txt
```

---

## 📞 获取帮助

如遇到问题，请提供以下信息：

1. 操作系统版本（Windows/macOS/Linux）
2. Python 版本（`python --version`）
3. 错误信息截图或日志
4. 网络环境描述

---

<div align="center">

**✨ 祝使用愉快！**

</div>
